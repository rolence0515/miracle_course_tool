{% extends "layout.html" %} {% block title %}OKRER{% endblock %} {% block head %}
<style type="text/css">
   


</style>
{% endblock %}
 {% block content %}
<h3 class="mb-3">OKR企業目標管理工具</h3>

<el-row class="mb-3">
    <el-col :span="24">
        <md-progress-bar md-mode="determinate" :md-value="progs"></md-progress-bar>
    </el-col>
</el-row>
<el-row class="mb-3" type="flex" justify="end">
        <el-col :span="24">
    
            <el-button @click="add_okr" type="primary" size="small" icon="el-icon-circle-plus" style="float: right;">新建OKR</el-button>
            <el-select size="small" class="mr-1" style="float:right" v-model="ftr" @change="on_ftr_change" placeholder="過濾">
                <el-option label="顯示全部" value="顯示全部">
                </el-option>
                <el-option label="顯示未完成" value="顯示未完成">
                </el-option>
                <el-option label="顯示已完成" value="顯示已完成">
                </el-option>
                <el-option label="顯示私人的" value="顯示私人的">
                </el-option>
                <el-option label="顯示我參與的" value="顯示我參與的">
                </el-option>
            </el-select>
        </el-col>
    </el-row>
<el-row >
    <el-col class="mb-1" :span="24">
        
        <el-tabs v-model="act_tab_name" @tab-click="on_tab_click" :tab-position="isMobile() ? 'top' : 'left'">
            <el-tab-pane id="0" class="reg-text" label="年度目標">
                <v-okr @okr_del="on_okr_del" v-bind:key="okr.id" v-for="okr in okrs" :okr="okr" :allmembers="all_members"></v-okr>
            </el-tab-pane>
            <el-tab-pane id="1" class="reg-text" label="Q1目標">
                <v-okr v-bind:key="okr.id" v-for="okr in okrs" :okr="okr" :allmembers="all_members"></v-okr>
            </el-tab-pane>
            <el-tab-pane id="2" class="reg-text" label="Q2目標">
        
            </el-tab-pane>
            <el-tab-pane id="3" class="reg-text" label="Q3目標">
        
            </el-tab-pane>
            <el-tab-pane id="4" class="reg-text" label="Q4目標">
        
            </el-tab-pane>
            <el-tab-pane id="５" class="reg-text" label="本月目標">
        
            </el-tab-pane>
            <el-tab-pane id="５" class="reg-text" label="本週目標">
        
            </el-tab-pane>
        </el-tabs>

      
    </el-col>
</el-row>


{% endblock %} 

{% block js %}
<script src="/static/js/minxin_is_mobile.js"></script>
<script src="/static/js/mixin_localstroage.js"></script>
<script src="/static/js/mixin_date.js"></script>
<script src="/static/js/v-kr.js?20190505"></script>
<script src="/static/js/v-okr.js?20190505"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.9.1/underscore-min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.0/clipboard.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/howler/2.1.1/howler.min.js"></script>
<script src="https://d.line-scdn.net/r/web/social-plugin/js/thirdparty/loader.min.js" async="async" defer="defer"></script>
<script>
</script>
<script>

    var app = new Vue({
        delimiters: ['[[', ']]'],
        el: '#layout',
        mixins: [layoutVue,mixindetictingmobile,mixinLocalStorge],//layout 資料
        breadpath: [{ key: '首頁', path: '' }],//面包序
        data: {
            okrs:[{
                    id:0,
                    isdark:false,
                    members: [],
                    complete: 2,
                    enddt: Date.now(),
                    o: "目標0",
                    krs: [
                        { id: 0, text: "", ishelp: false, rate: 3, members: [] },
                    ]
                },
                {
                    id:1,
                    isdark:true,
                    members: [],
                    complete: 2,
                    enddt: Date.now(),
                    o: "目標1",
                    krs: [
                        { id: 0, text: "", ishelp: false, rate: 3, members: [] },
                    ]
                },
            ],
            ftr:'顯示全部',
            progs:9,
            act_tab_name:'',
            all_members:['唐僧','悟空','八戒','沙僧'],
        },
        methods: {
            okr_animate_bouncein(okrid){
                setTimeout( ()=> {
                    //停四百毫秒後做效果
                    var element = document.querySelector('#okr_' + okrid)
                    element.classList.remove('animated', 'bounceIn' ,'fast')
                    element.classList.add('animated', 'bounceIn', 'fast')
                    LineIt.loadButton();
                }, 400);
            },
            okr_animate_bounceout(okrid, thenfunc){
                var element = document.querySelector('#okr_' + okrid)
                    element.classList.remove('animated', 'bounceOutLeft' ,'fast')
                    element.classList.add('animated', 'bounceOutLeft', 'fast')
                    LineIt.loadButton();
                setTimeout(thenfunc, 600);
            },
          
            add_okr(){
                okrid = this.okrs.length;
                this.okrs.unshift({
                    id:okrid,
                    isdark:false,
                    members: [],
                    complete: 2,
                    enddt: Date.now(),
                    o: "",
                    krs: [
                        { id: 0, text: "", ishelp: false, rate: 0, members: [] },
                    ]
                })

                this.okr_animate_bouncein(okrid);
                
            },

            on_okr_del(okrid){
                this.$confirm('此操作將永遠刪除OKR, 是否確定？', '提示', {
                    confirmButtonText: '確定',
                    cancelButtonText: '取消',
                    type: 'warning'
                }).then(() => {

                    this.okr_animate_bounceout(okrid, ()=> {
                        app.okrs = _.filter(app.okrs, (okr) => {
                            return okr.id != okrid;
                        })
                        app.$message({
                            type: 'success',
                            message: '刪除成功!'
                        });
                    });
                }).catch(() => {
                    app.$message({
                        type: 'info',
                        message: '已取消刪除'
                    });
                });
            },

            on_ftr_change(){
              
            },
            on_tab_click(){

            }
        },
        watch: {
            
        },
        mounted:function () {
            this.init_ls("home", ['ftr','act_tab_name'])
        }
});

</script> 
{% endblock %}